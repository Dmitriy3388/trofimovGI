{% extends "mebel/base.html" %}
{% load static %}

{% block title %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ #{{ operation.id }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ #{{ operation.id }}
                    </h5>
                </div>
                <div class="card-body">
                    <div class="alert alert-warning">
                        <strong>–í–Ω–∏–º–∞–Ω–∏–µ!</strong> –ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –±–∞–ª–∞–Ω—Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞.
                        –ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è.
                    </div>

                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
                    <div class="mb-4">
                        <h6>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–ø–µ—Ä–∞—Ü–∏–∏:</h6>
                        <ul class="list-group">
                            <li class="list-group-item">
                                <strong>–ú–∞—Ç–µ—Ä–∏–∞–ª:</strong>
                                <a href="{{ operation.material.get_absolute_url }}">
                                    {{ operation.material.name }}
                                </a>
                            </li>
                            <li class="list-group-item">
                                <strong>–¢–∏–ø:</strong>
                                {% if operation.operation_type == 'receipt' %}
                                    <span class="badge bg-success">–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ</span>
                                {% else %}
                                    <span class="badge bg-danger">–°–ø–∏—Å–∞–Ω–∏–µ</span>
                                {% endif %}
                            </li>
                            <li class="list-group-item">
                                <strong>–¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:</strong> {{ operation.quantity }} —à—Ç.
                            </li>
                            <li class="list-group-item">
                                <strong>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong> {{ operation.created|date:"d.m.Y H:i" }}
                            </li>
                        </ul>
                    </div>
                    <!-- –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –±–ª–æ–∫ –ø–æ—Å–ª–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
                    <div class="mb-3">
                        <h6>–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:</h6>
                        <ul class="list-group">
                            <li class="list-group-item">
                                <strong>–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞:</strong> {{ material.balance }} —à—Ç.
                            </li>
                            <li class="list-group-item">
                                <strong>–ò—Å—Ö–æ–¥–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –æ–ø–µ—Ä–∞—Ü–∏–∏:</strong> {{ operation.quantity }} —à—Ç.
                            </li>
                            {% if operation.operation_type == 'write_off' %}
                            <li class="list-group-item">
                                <strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ —Å–ø–∏—Å–∞—Ç—å:</strong> {{ material.balance|add:operation.quantity }} —à—Ç.
                            </li>
                            {% endif %}
                        </ul>
                    </div>
                    <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
                    <form method="post">
                        {% csrf_token %}

                        {% include "includes/form_errors.html" with form=form %}

                        <div class="mb-3">
                            <label class="form-label">{{ form.quantity.label }}</label>
                            {{ form.quantity }}
                            <div class="form-text">
                                –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:
                                {% if operation.operation_type == 'write_off' %}
                                    {{ operation.material.balance|add:operation.quantity }} —à—Ç.
                                {% else %}
                                    –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ
                                {% endif %}
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">{{ form.notes.label }}</label>
                            {{ form.notes }}
                        </div>

                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-warning">
                                üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                            </button>
                            <a href="{% url 'mebel:operations_list' %}" class="btn btn-secondary">
                                –û—Ç–º–µ–Ω–∞
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}