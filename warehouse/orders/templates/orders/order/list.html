{% extends "mebel/base.html" %}

{% block title %}Order List{% endblock %}

{% block content %}
  <h1>Order List</h1>

  <table class="order-list">
    <thead>
      <tr>
        <th>ID</th>
        <th>Имя заказа</th>
        <th>Дата создания</th>
        <th>Цена</th>
        <th>Оплата</th>
      </tr>
    </thead>
    <tbody>
      {% for order in page_obj %}
      <tr class="clickable-row" data-href="{% url 'orders:order_detail' order.id %}">
        <td>{{ order.id }}</td>
        <td>{{ order.first_name }} {{ order.last_name }}</td>
        <td>{{ order.created|date:"d.m.Y H:i" }}</td>
        <td>${{ order.get_total_cost }}</td>
        <td>
        {% if order.paid == 'fully_paid' %}
        <span style="color: green; font-weight: bold;">✓ Оплачено</span>
        {% elif order.paid == 'partially_paid' %}
        <span style="color: orange; font-weight: bold;">⏳ Оплачено частично</span>
        {% else %}
        <span style="color: red; font-weight: bold;">✗ Не оплачено</span>
        {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Пагинация -->
  {% include "pagination.html" %}

  <style>
    .order-list {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    .order-list th, .order-list td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: left;
    }
    .clickable-row {
      cursor: pointer;
    }
    .clickable-row:hover {
      background-color: #f5f5f5;
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const rows = document.querySelectorAll('.clickable-row');
      rows.forEach(row => {
        row.addEventListener('click', function() {
          window.location.href = this.dataset.href;
        });
      });
    });
  </script>
{% endblock %}