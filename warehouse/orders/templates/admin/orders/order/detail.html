{% extends "admin/base_site.html" %}
{% load static %}

{% block extrastyle %}
    {{ block.super }}
    <style>
        .order-details {
            margin: 20px 0;
        }
        .order-details .field {
            margin-bottom: 10px;
        }
        .order-details .field-label {
            font-weight: bold;
            display: inline-block;
            width: 150px;
        }
        .image-preview {
            margin: 10px 0;
            max-width: 300px;
        }
        .image-preview img {
            max-width: 100%;
            height: auto;
        }
    </style>
{% endblock %}

{% block content %}
    <h1>Заказ #{{ order.id }}</h1>

    <div class="order-details">
        <div class="field">
            <span class="field-label">Название:</span>
            {{ order.order_name }}
        </div>
        <div class="field">
            <span class="field-label">Имя заказчика:</span>
            {{ order.customer_name }}
        </div>
        <div class="field">
            <span class="field-label">Адрес:</span>
            {{ order.address }}
        </div>
        <div class="field">
            <span class="field-label">Перечисленные средства:</span>
            {{ order.transferred_amount }} руб.
        </div>
        <div class="field">
            <span class="field-label">Скидка:</span>
            {{ order.discount }}%
        </div>
        <div class="field">
            <span class="field-label">Категория:</span>
            {{ order.get_category_display }}
        </div>
        <div class="field">
            <span class="field-label">Статус оплаты:</span>
            {{ order.get_paid_display }}
        </div>
        <div class="field">
            <span class="field-label">Дата создания:</span>
            {{ order.created }}
        </div>
        <div class="field">
            <span class="field-label">Последнее обновление:</span>
            {{ order.updated }}
        </div>

        <div class="field">
            <span class="field-label">Чертеж:</span>
            <div class="image-preview">
                {{ display_blueprint }}
            </div>
        </div>

        <div class="field">
            <span class="field-label">Визуализация:</span>
            <div class="image-preview">
                {{ display_visualization }}
            </div>
        </div>

        <div class="field">
            <span class="field-label">Общая стоимость:</span>
            {{ order.get_total_cost }} руб.
        </div>
    </div>

    <h2>Позиции заказа</h2>
    <table>
        <thead>
            <tr>
                <th>Материал</th>
                <th>Цена</th>
                <th>Количество</th>
                <th>Стоимость</th>
            </tr>
        </thead>
        <tbody>
            {% for item in order.items.all %}
                <tr>
                    <td>{{ item.material.name }}</td>
                    <td>{{ item.price }} руб.</td>
                    <td>{{ item.quantity }}</td>
                    <td>{{ item.get_cost }} руб.</td>
                </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <td colspan="3"><strong>Итого:</strong></td>
                <td><strong>{{ order.get_total_cost }} руб.</strong></td>
            </tr>
        </tfoot>
    </table>
{% endblock %}